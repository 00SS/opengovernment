- content_for :head do
  = auto_discovery_link_tag(:atom, {:action => 'major_actions', :format => :atom}, {:title => "Major Actions"})
  = auto_discovery_link_tag(:atom, {:format => :atom}, {:title => "All Actions"})

- title("#{@bill.state.name} #{@bill.chamber.name} Bill #{@bill.bill_number}")
- track(@bill)

.grid_16
  %h1.grid_13.alpha= "#{@bill.state.name} #{@bill.chamber.name} Bill #{@bill.bill_number}"

%hr.grid_16


%nav.grid_4
  #left_nav
    = render_navigation(:level => 3)

.grid_12
  .grid_12.alpha
    = render :partial => 'shared/view_counts', :locals => {:page => @bill}

  %hr

  .grid_12.full_lined.alpha
    .grid_6.alpha
      Track via RSS:
      = link_to "All actions", {:actions => 'all', :format => :atom}
      = link_to "Major actions", {:actions => 'major', :format => :atom}
    .grid_6.omega
      Session: #{raw @bill.session.name_fm}


  %p.grid_12.alpha.summary= @bill.title

  %hr

  .grid_6.alpha
    %h2 Sponsors
    %ul.lined
      - @bill.sponsorships.includes(:sponsor).order("people.last_name").each do |s|
        %li
          - surround '',',' do
            = link_to(s.sponsor.full_name, person_path(s.sponsor))
          = s.kind_fm
  .grid_6.omega


  %aside.grid_2.omega
    .track
      Track this bill via RSS or e-mail
    .discuss
      Discussion Forum
    .support
      = link_to 'I support', '#'
      /
      = link_to 'I oppose', '#'
      this bill!

    - if @bill.versions.count > 0
      %h2 Versions

      %ul.lined
        - @bill.versions.each do |version|
          %li
            = link_to(version.name, version.url)

  %hr.push_top

  - if @bill.major_actions.count > 0
    %h2 #{link_to "Major Actions", url_for(:actions => 'major'), :remote => true} | #{link_to "All Actions", url_for(:actions => 'all'), :remote => true}
    .grid_12.last
      #bill_actions= render :partial => 'actions_table', :locals => {:actions => @actions}

  - if @bill.votes.count > 0
    %h2 Votes
    %table.vote-summary.grid_12.alpha
      %thead
        %tr
          %th.vote-motion Motion
          %th.vote-votes Total Votes
          %th.centered Yes
          %th.centered No
          %th.centered Other
          %th Outcome

      %tbody
        - @bill.votes.each do |vote|
          %tr
            %td(rowspan=2)
              %h4= link_to("#{vote.motion}", vote_path(vote))
              %br
              .vote-summary-line
                %span.voters= vote.total_count
                people voted on
                %span.vote_date= vote.date
            %td.votes{:rowspan => 2}
              %span.total-votes.rounded= vote.total_count
            %td.votes.centered{:rowspan => 2, :class => vote.passed? ? 'vote-passed' : ''}
              %span.vote-yes.rounded= vote.yes_count.round
            %td.votes.centered{:rowspan => 2, :class => vote.passed? ? '' : 'vote-failed'}
              %span.vote-no.rounded= vote.no_count.round
            %td.votes.centered(rowspan=2)
              %span.other-votes.rounded= vote.other_count.round
            %td{:colspan => 3, :class => 'vote-needed-bar'}
              %span{:class => 'vote-needed', :style => "width: #{number_with_precision(vote.needed_to_pass_pct)}%;"} &nbsp;
          %tr
            %td.vote-bar
              %span{:class => 'vote-yes-block', :style => "width: #{number_with_precision(vote.yes_pct)}%;"} &nbsp;
              %span{:class => 'vote-no-block', :style => "width: #{number_with_precision(vote.no_pct)}%;"} &nbsp;
              %span{:class => 'vote-other-block', :style => "width: #{number_with_precision(vote.other_pct)}%;"} &nbsp;


  %hr

  %div.social
    %p Tweet this bill using the hashtags #{@bill.to_hashtags}
